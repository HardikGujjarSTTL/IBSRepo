@model IBS.Models.LabReportsModel

<div>
    <h3 class="center">(@ViewBag.Region)</h3>


    <h3 class="center">Lab Register Report For The Period: <span class="orangeText"> @ViewBag.From </span> To <span class="orangeText">@ViewBag.To </span></h3>

    <br>
    <div class="tableOuter">
        <table class="borderTable" cellpadding="0" cellspacing="0">
            <tbody>
                <tr>

                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">S.No.</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Sample Reg No.</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Sample Reg Date</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Case No.</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Call Date</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Call Sno</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Testing Type</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Code No</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Code Date</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Vendor</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">IE</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Lab</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Item</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Test</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Sample Dispatch to Lab Date</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Test Report Receipt Date</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Testing Result</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">No.of Samples</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Remarks</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Testing Charges</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Service Tax</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Handling Charges</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Amount Cleared By DD</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">TDS</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">TDS Date</font></b></th>
                    <th width="25%" valign="top" align="center"><b><font sizw="1" face="Verdana">Due</font></b></th>
                    

                </tr>
                @if (Model != null && Model.lstLabReport != null && Model.lstLabReport.Count > 0)
                {
                    var serialNumber = 1;
                    @foreach (var item in Model.lstLabReport)
                    {

                        <tr>
                            <td width="3%" valign="top" align="Left"><font size="1" face="Verdana">@serialNumber</font></td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.SAMPLE_REG_NO
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.SAMPLE_REG_DATE
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.CASE_NO
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.CALL_RECV_DATE
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.CALL_SNO
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.T_TYPE
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.CODE_NO
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.CODE_DATE
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.VENDOR
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.IE_NAME
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.LAB
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.ITEM_DESC
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.TEST
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.SAMPLE_DISPATCH_DATE
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.TEST_REPORT_REC_DATE
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.TEST_STATUS
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.NO_OF_SAMPLES
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.REMARKS
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.TESTING_FEE
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.SERVICE_TAX
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.HANDLING_CHARGES
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.AMOUNT_RECIEVED
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.TDS_AMT
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.TDS_DATE
                                </font>
                            </td>
                            <td width="25%" valign="top" align="Left">
                                <font size="1" face="Verdana">
                                    @item.AMT_DUE
                                </font>
                            </td>
                            
                        </tr>
                        serialNumber++;
                    }

                    @* int sumTesting = Model.lstLabReport.Sum(item => int.TryParse(item.TESTING_FEE, out int fee) ? fee : 0);
                    int sumService = Model.lstLabReport.Sum(item => int.TryParse(item.SERVICE_TAX, out int tax) ? tax : 0);
                    int sumHandling = Model.lstLabReport.Sum(item => int.TryParse(item.HANDLING_CHARGES, out int charges) ? charges : 0);
                    int sumAmtRec = Model.lstLabReport.Sum(item => int.TryParse(item.AMOUNT_RECIEVED, out int received) ? received : 0);
                    int sumTDS = Model.lstLabReport.Sum(item => int.TryParse(item.TDS_AMT, out int tds) ? tds : 0);
                    int sumAmtDue = Model.lstLabReport.Sum(item => int.TryParse(item.AMT_DUE, out int due) ? due : 0); *@
                    int sumTesting = Model.lstLabReport.Sum(item => !string.IsNullOrEmpty(item.TESTING_FEE) && int.TryParse(item.TESTING_FEE, out int fee) ? fee : 0);
                    int sumService = Model.lstLabReport.Sum(item => !string.IsNullOrEmpty(item.SERVICE_TAX) && int.TryParse(item.SERVICE_TAX, out int fee) ? fee : 0);
                    int sumHandling = Model.lstLabReport.Sum(item => !string.IsNullOrEmpty(item.HANDLING_CHARGES) && int.TryParse(item.HANDLING_CHARGES, out int fee) ? fee : 0);
                    int sumAmtRec = Model.lstLabReport.Sum(item => !string.IsNullOrEmpty(item.AMOUNT_RECIEVED) && int.TryParse(item.AMOUNT_RECIEVED, out int fee) ? fee : 0);
                    int sumTDS = Model.lstLabReport.Sum(item => !string.IsNullOrEmpty(item.TDS_AMT) && int.TryParse(item.TDS_AMT, out int fee) ? fee : 0);
                    int sumAmtDue = Model.lstLabReport.Sum(item => !string.IsNullOrEmpty(item.AMT_DUE) && int.TryParse(item.AMT_DUE, out int fee) ? fee : 0);

                    <tr class="reportTotal">
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td></td>
                        <td width="15%" valign="top" align="center" colspan="1"><font size="1" face="Verdana"><b>Total</b></font></td>
                        <td width="7%" valign="top" align="center"><font size="1" face="Verdana"><b>@sumTesting</b></font></td>
                        <td width="7%" valign="top" align="center"><font size="1" face="Verdana"><b>@sumService</b></font></td>
                        <td width="7%" valign="top" align="center"><font size="1" face="Verdana"><b>@sumHandling</b></font></td>
                        <td width="7%" valign="top" align="center"><font size="1" face="Verdana"><b>@sumAmtRec</b></font></td>
                        <td width="7%" valign="top" align="center"><font size="1" face="Verdana"><b>@sumTDS</b></font></td>
                        <td></td>
                        <td width="7%" valign="top" align="center"><font size="1" face="Verdana"><b>@sumAmtDue</b></font></td>

                    </tr>


                }
                else
                {
                    <tr>
                        <td colspan="5" class="noRecordGrid">No records found</td>
                    </tr>
                }
            </tbody>
        </table>
    </div>
</div>


