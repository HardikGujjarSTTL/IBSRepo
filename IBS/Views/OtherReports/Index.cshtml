@using System.Web;
@using IBS.Helper;
@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor;
@{
    string Region = ViewBag.Region;
    string ReportType = !string.IsNullOrEmpty(HttpContextAccessor.HttpContext.Request.Query["ReportType"]) ? Convert.ToString(HttpContextAccessor.HttpContext.Request.Query["ReportType"]) : "";
    string ReportTitle = EnumUtility<Enums.ManagementReportsTitle>.GetDescriptionByKey(ReportType);

    if (ReportType == "COWISEIE") ReportTitle = "Controlling Officer Wise IE";
    else if (ReportType == "COIEWiseCalls") ReportTitle = "CONTROLLING WISE CALLS MARKED";
    ViewData["Title"] = ReportTitle;
}

<div class="list-inner">
    <div class="tast-list">
        <h2>@ReportTitle</h2>
    </div>
</div>
<div class="task-listinput">
    <div class="accordion-body">
        <div class="task-inner row COIEWiseCalls" style="display: none">
            <div class="col-md-3 mb-3" style="font-weight: bold;">
                <div class="reference">
                    <label for="dpCO">Controlling Officer</label>
                    @Html.DropDownList("dpCO", new SelectList(IBS.Models.Common.GetControllingOfficers(ViewBag.Region) , "Value", "Text"),new { @onchange = "BindlstIE();" })
                </div>
            </div>
            <div class="col-md-3 mb-3" style="font-weight: bold;">
                <div class="reference">
                    <label for="status">Status of Call</label>
                    @Html.DropDownList("status", new SelectList(IBS.Models.Common.CallStatus().OrderBy(X => X.Text) , "Value", "Text"),"All")
                </div>
            </div>

            <div class="col-md-4 mb-3" style="font-weight: bold;width:auto;">
                <div class="reference">
                    <label for="rdbIE">Inspection Engineer</label>
                    @Html.RadioButton("rdbIE", "AllIE", new { @id="rdAllIE", @class = "text-darkblue font-bold font-size-8pt", @checked = true }) All IE
                    &nbsp;&nbsp;
                    @Html.RadioButton("rdbIE", "PartiIE", new { @id="rdPIE",@class = "text-darkblue font-bold font-size-8pt"}) Particular IE
                </div>
            </div>

            <div class="col-md-3 mb-3" style="font-weight: bold;">
                <div class="reference">
                    <label for="dpIE"></label>
                    @Html.DropDownList("dpIE", new SelectList(IBS.Models.Common.GetControllingSelectedIE(ViewBag.Region,"") , "Value", "Text"),"-- Select --")
                </div>
            </div>

            <div class="row my-0 ">
                <div class="col-md-4 mb-3" style="font-weight: bold;">
                    <div class="reference">
                        <label for="rdbSort">Report Sorted On</label>
                        @Html.RadioButton("rdbSort", "CallDate", new { @id="rdCallDate", @class = "text-darkblue font-bold font-size-8pt", @checked = true }) Call Date
                        &nbsp;&nbsp;
                        @Html.RadioButton("rdbSort", "Vendor", new { @id="rdVendor",@class = "text-darkblue font-bold font-size-8pt"}) Vendor
                    </div>
                </div>
            </div>
            <div class="row my-0">
                <div class="col-md-3" style="margin-top: 30px;">
                    <div class="savenext-btn">
                        <button type="button" class="save-btn active" onclick="InitializeDatatable();">Submit</button>
                        <button type="button" class="reset-btn" onclick="ClearControls1();">Clear</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="task-inner row C" style="display: none">
            <form role="form" asp-controller="OtherReports" asp-action="ManageReportData" id="frmC">
                <input type="hidden" id="hdnReportType" name="hdnReportType" />
                <input type="hidden" id="hdnformonth" name="hdnformonth" />
                <input type="hidden" id="hdnforperiod" name="hdnforperiod" />
                <input type="hidden" id="hdnFromDate" name="hdnFromDate" />
                <input type="hidden" id="hdnToDate" name="hdnToDate" />
                <input type="hidden" id="hdnmonth" name="hdnmonth" />
                <input type="hidden" id="hdnyear" name="hdnyear" />
                <input type="hidden" id="hdnAllCM" name="hdnAllCM" />
                <input type="hidden" id="hdnforCM" name="hdnforCM" />
                <input type="hidden" id="hdniecmname" name="hdniecmname" />
                <input type="hidden" id="hdnAll" name="hdnAll" />
                <input type="hidden" id="hdnOutstanding" name="hdnOutstanding" />
                <input type="hidden" id="hdnmonthtxt" name="hdnmonthtxt" />
                <input type="hidden" id="hdnIENametext" name="hdnIENametext" />
                <div class="col-md-6">
                    <div class="custom-readio">
                        <div class="company-checkbox">
                            <div class="remember">
                                <div class="remecheckbox">
                                    <input type="radio" id="formonth" name="formonth" value="formonth" checked>
                                    <label for="formonth">For The Month</label>
                                </div>
                            </div>
                            <div c lass="remember">
                                <div class="remecheckbox">
                                    <input type="radio" id="forperiod" name="formonth" value="forperiod">
                                    <label for="forperiod">For Given Period</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="row align-items-end my-0" id="divdate">
                    <div class="col-md-3">
                        <div class="input-search">
                            <label for="FromDate">For The Period From</label>
                            <input type="text" class="datepicker" id="FromDate" placeholder="DD/MM/YYYY" />
                            <span class="text-danger field-validation-error" id="spnErrorFromDate"></span>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="input-search">
                            <label for="ToDate">To</label>
                            <input type="text" class="datepicker" id="ToDate" placeholder="DD/MM/YYYY" />
                            <span class="text-danger field-validation-error" id="spnErrorToDate"></span>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="savenext-btn">
                            <button type="button" class="save-btn active" onclick="SubmitNCRC();">Generate Report</button>
                            <button type="button" class="reset-btn" onclick="ClearControls1();">Clear</button>
                        </div>
                    </div>
                </div>
                <div class="row align-items-end my-0" id="divmonth">
                    <div class="col-md-3">
                        <div class="input-search">
                            <label for="FromDate">Month</label>
                            @Html.DropDownList("month", new SelectList(IBS.Models.Common.GetMonths() , "Value", "Text"),"--Select--" ,new { id = "month" })
                            <span class="text-danger field-validation-error" id="spnErrormonth"></span>
                        </div>
                    </div>
                    <div class="col-md-3 mb-4">
                        <div class="input-search">
                            <label for="ToDate">Year</label>
                            @Html.DropDownList("year", new SelectList(IBS.Models.Common.GetYears() , "Value", "Text"),"--Select--", new { id = "year" })
                            <span class="text-danger field-validation-error" id="spnErroryear"></span>
                        </div>
                    </div>
                    <div class="col-md-4">
                        <div class="savenext-btn">
                            <button type="button" class="save-btn active" onclick="SubmitNCRC();">Generate Report</button>
                            <button type="button" class="reset-btn" onclick="ClearControls1();">Clear</button>
                        </div>
                    </div>
                </div>
                @if (ReportType == "I")
                {
                    <div class="col-md-12 custom-readio">
                        <div class="company-checkbox">
                            <div class="remember">
                                <label for="year">Status of CM's</label> &nbsp;&nbsp; &nbsp;&nbsp;
                                <div class="remecheckbox">
                                    <input type="radio" value="AllCM" id="AllCM" name="AllCM" checked="checked" />
                                    <label for="AllCM">All IE</label>
                                    &nbsp;&nbsp;
                                    <input type="radio" value="forCM" id="forCM" name="AllCM" />
                                    <label for="forCM">For Given IE</label>
                                </div>
                            </div>
                        </div>
                    </div>
                }
                <br />
                @if (ReportType == "C")
                {
                    <div class="col-md-12 custom-readio">
                        <div class="company-checkbox">
                            <div class="remember">
                                <label for="year">Status of CM's</label> &nbsp;&nbsp; &nbsp;&nbsp;
                                <div class="remecheckbox">
                                    <input type="radio" value="AllCM" id="AllCM" name="AllCM" checked="checked" />
                                    <label for="AllCM">All CM</label>
                                    &nbsp;&nbsp;
                                    <input type="radio" value="forCM" id="forCM" name="AllCM" />
                                    <label for="forCM">For Given CM</label>
                                </div>
                            </div>
                        </div>
                    </div>
                }
                <div class="col-md-3">
                    @Html.DropDownList("iecmname", new SelectList(IBS.Models.Common.GetCOData(@ViewBag.Region) , "Value", "Text"),"--Select--", new { id = "iecmname" })
                </div>
                <br />
                <div class="custom-readio">
                    <div class="company-checkbox">
                        <div class="remember">
                            <label for="year">Report Type</label> &nbsp;&nbsp; &nbsp;&nbsp;
                            <div class="remecheckbox">
                                <input type="radio" value="All" id="All" name="All" checked="checked" />
                                <label for="All">All</label>
                                &nbsp;&nbsp;
                                <input type="radio" value="Outstanding" id="Outstanding" name="All" />
                                <label for="Outstanding">Outstanding</label>
                            </div>
                        </div>
                    </div>
                </div>
        </form>
        </div>

        <div class="task-inner row IEWISET" style="display: none">
            <form role="form" asp-controller="OtherReports" asp-action="ManageReportData" id="frmIEWISET">
                    <input type="hidden" id="hdnReportType" name="hdnReportType" />
                    <input type="hidden" id="hdnIENAME" name="hdnIENAME" />
                    <input type="hidden" id="hdnMechanical" name="hdnMechanical" />
                    <input type="hidden" id="hdnElectrical" name="hdnElectrical" />
                    <input type="hidden" id="hdnCivil" name="hdnCivil" />
                    <input type="hidden" id="hdnRegular" name="hdnRegular" />
                    <input type="hidden" id="hdnDeputaion" name="hdnDeputaion" />
                    <input type="hidden" id="hdnParticularie" name="hdnParticularie" />
                    <input type="hidden" id="hdnParticularArea" name="hdnParticularArea" />
                <div class="col-md-12">
                    <h3 class="heading3 mb-4">Discipline</h3>
                    <div class="col-md-12">
                        <ul class="radioListForm m-0">
                            <li>
                                <input type="radio" id="Alldescipline" name="Discipline" checked="checked" value="Alldescipline">
                                <label for="Alldescipline">All</label>
                            </li>
                            <li>
                                <input type="radio" id="Mechanical" name="Discipline" value="Mechanical">
                                <label for="Mechanical">Mechanical</label>
                            </li>
                            <li>
                                <input type="radio" id="Electrical" name="Discipline" value="Electrical">
                                <label for="Electrical">Electrical</label>
                            </li>
                            <li>
                                <input type="radio" id="Civil" name="Discipline" value="Civil">
                                <label for="Civil">Civil</label>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-md-12">
                    <h3 class="heading3 mb-4">IE Category</h3>
                    <div class="col-md-12" id="detaileds">
                        <ul class="radioListForm m-0">
                            <li>
                                <input type="radio" id="AllIeCat" name="IECategory" checked="checked" value="AllIeCat">
                                <label for="AllIeCat">All</label>
                            </li>
                            <li>
                                <input type="radio" id="Regular" name="IECategory" value="Regular">
                                <label for="Regular">Regular</label>
                            </li>
                            <li>
                                <input type="radio" id="Deputaion" name="IECategory" value="Deputaion">
                                <label for="Deputaion">Deputaion</label>
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-md-12">
                    <h3 class="heading3 mb-4">IE</h3>
                    <div class="col-md-12">
                        <ul class="radioListForm m-0">
                            <li>
                                <input type="radio" id="AllIe" name="AllIe" checked="checked" value="AllIe">
                                <label for="AllIe">All IE</label>
                            </li>
                            <li>
                                <input type="radio" id="Particularie" name="AllIe" value="Particularie">
                                <label for="Particularie">Particular IE</label>
                            </li>
                            <li>
                                @Html.DropDownList("IENAME", new SelectList(IBS.Models.Common.GetIENameIsStatusNull(@ViewBag.Region), "Value", "Text"), "--Select--", new { id = "IENAME" })
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="col-md-12">
                    <h3 class="heading3 mb-4">Training Area</h3>
                    <div class="col-md-12">
                        <ul class="radioListForm m-0">
                            <li>
                                <input type="radio" id="AllArea" name="AllArea" checked="checked" value="AllArea">
                                <label for="AllArea">All</label>
                            </li>
                            <li>
                                <input type="radio" id="ParticularArea" name="AllArea" value="ParticularArea">
                                <label for="ParticularArea">Particular Area</label>
                            </li>
                            <li>
                                @Html.DropDownList("TrainingArea", new SelectList(IBS.Models.Common.TrainingArea(), "Value", "Text"), "--Select--", new { id = "TrainingArea" })
                            </li>
                        </ul>
                    </div>
                </div>
                <div class="savenext-btn">
                    <button type="button" class="save-btn active" onclick="ViewReportIEWISET();">Submit</button>
                    <button type="button" class="reset-btn" onclick="ClearControlsIEWISET();">Clear</button>
                </div>
             </form>
        </div>
    </div>
    <section class="table-section COIEWiseCalls" id="tblCOIEWiseCalls" style="display: none">
        <div class="task-listinput">
            <div class="dash-table">
                <table id="dtCOIEWiseCalls" class="table-responsive">
                    <thead>
                        <tr>
                            <th>VIEW REPORT</th>
                            <th>IE Name</th>
                            <th>VENDOR NAME</th>
                            <th>NEW VENDOR</th>
                            <th>PURCHASER</th>
                            <th>ITEM</th>
                            <th>DELV DATE</th>
                            <th>INSP DESIRE DATE</th>
                            <th>CALL DATE</th>
                            <th>CALL SERIAL NO.</th>
                            <th>CALL DOCUMENT(IF ANY).</th>
                            <th>CASE NO/VIEW PO</th>
                            @*<th style="display:none;" class="takenworkplan">TAKEN IN TODAY'S WORKPLAN</th> Hide*@
                            <th>PO SOURCE</th>
                            <th>STATUS</th>
                            @*<th>VIEW IC</th>*@
                            <th>REMARKS</th>
                            <th>PONO</th>
                            <th>PO DATE</th>
                            <th>CONTACT PERSON</th>
                            <th>CONTACT PERSON PHONE NO.</th>
                            <th>USER</th>
                            <th>LAST UPDATION DATE</th>
                        </tr>
                    </thead>
                    <tbody>
                    </tbody>
                </table>
            </div>
        </div>
    </section>
</div>

@section scripts{
    <partial name="_DataTablesScriptsPartial" />
    <partial name="_ValidationScriptsPartial" />

    <script type="text/javascript">
        $(document).ready(function () {

            $("#divdate").hide();
            $("#iecmname").hide();
            $("#IENAME").hide();
            $("#TrainingArea").hide();

            BindlstIE();
            if ('@ReportType' == 'COWISEIE') {
                ViewReportCOWISEIE();
            }
            else if ('@ReportType' == "COIEWiseCalls") {
                $(".COIEWiseCalls").css("display", "");
                $("#dpIE").css("display", "none");
                $('input[type=radio][name=rdbIE]').change(function () {
                    var value = $(this).val();
                    if (value == "AllIE") {
                        $("#dpIE").css("display", "none");
                    } else {
                        var CO = $("#dpCO").val();
                        if (CO != "") {
                            $("#dpIE").css("display", "");
                        }
                    }
                });
            }
            else if ('@ReportType' == 'C' || '@ReportType' == 'I') {
                 $(".C").css("display", "");
            } else if ('@ReportType' == 'IEWISET') {
                $(".IEWISET").css("display", "");
            }

            $('#Particularie').change(function () {
                $("#IENAME").show();
            });

            $('#ParticularArea').change(function () {
                $("#TrainingArea").show();
            });

            $('#AllIe').change(function () {
                $("#IENAME").val('');
                $("#TrainingArea").val('');
                $("#TrainingArea").hide();
                $("#IENAME").hide();
            });

            $('#AllArea').change(function () {
                $("#IENAME").val('');
                $("#TrainingArea").val('');
                $("#TrainingArea").hide();
                $("#IENAME").hide();
            });

            $('#AllIeCat').change(function () {
                $("#IENAME").val('');
                $("#TrainingArea").val('');
                $("#TrainingArea").hide();
                $("#IENAME").hide();
            });

            $('#Regular').change(function () {
                $("#IENAME").val('');
                $("#TrainingArea").val('');
                $("#TrainingArea").hide();
                $("#IENAME").hide();
            });

            $('#Deputaion').change(function () {
                $("#IENAME").val('');
                $("#TrainingArea").val('');
                $("#TrainingArea").hide();
                $("#IENAME").hide();
            });

            $('#Alldescipline').change(function () {
                $("#IENAME").val('');
                $("#TrainingArea").val('');
                $("#TrainingArea").hide();
                $("#IENAME").hide();
            });

            $('#Mechanical').change(function () {
                $("#IENAME").val('');
                $("#TrainingArea").val('');
                $("#TrainingArea").hide();
                $("#IENAME").hide();
            });

            $('#Electrical').change(function () {
                $("#IENAME").val('');
                $("#TrainingArea").val('');
                $("#TrainingArea").hide();
                $("#IENAME").hide();
            });

            $('#Civil').change(function () {
                $("#IENAME").val('');
                $("#TrainingArea").val('');
                $("#TrainingArea").hide();
                $("#IENAME").hide();
            });
        });


        $('#forperiod').change(function () {
            $("#divdate").show();
            $("#divmonth").hide();
            $("#month").val('');
            $("#year").val('');
        });

        $('#formonth').change(function () {
            $("#divdate").hide();
            $("#divmonth").show();
            $("#FromDate").val('');
            $("#ToDate").val('');
        });

        $('#forCM').change(function () {
            $("#iecmname").show();
        });

        $('#AllCM').change(function () {
            $("#iecmname").hide();
        });

        function ViewReportCOWISEIE() {
            var ReportType = '@ReportType';
            let myObject = { ReportType };
            var url = '@Url.Action("Manage", "OtherReports")?' + $.param(myObject);
            window.open(url, '_blank');
        }

        function ViewReportCOIEWiseCalls(Case_No, Call_Recv_Date, Call_SNo) {
            var ReportType = '@ReportType';
            //var CO = $("#dpCO").val();
            //var Status = $("#status").val();
            //var IE = $("#dpIE").val();
            //var IsAllPartiIE = $("#rdAllIE").is(":checked");
            //var IsCallDate = $("#rdCallDate").is(":checked");
            //if (IsAllPartiIE) {
            //    IE = null;
            //}
            let myObject = { ReportType, Case_No, Call_Recv_Date, Call_SNo };
            var url = '@Url.Action("ManageCoIeWiseCalls", "OtherReports")?' + $.param(myObject);
            window.open(url, '_blank');
        }

        function BindlstIE() {
            $("#dpIE").empty();
            $("#dpIE").append($('<option value="">--Select--</option>'));

            $.get("@Url.Action("GetIE", "OtherReports")", { CO: $("#dpCO").val() }, function (response) {
                if (response != null) {
                    $("#dpIE").empty();
                    $("#dpIE").append($('<option value="">--Select--</option>'));
                    $.each(response.list, function (ind, val) {
                        $("#dpIE").append($('<option></option>').val(val.Value).html(val.Text));
                    });
                }
            });
        }
        function InitializeDatatable() {
            var CO_CD = $("#dpCO").val();
            var Status_Call = $("#status").val();
            var IE_CD = $("#dpIE").val();
            var IsAllIE_Call = $("#rdAllIE").is(":checked") == true ? "true" : "false";
            var IsCallDate_Sort = $("#rdCallDate").is(":checked") == true ? "true" : "false";
            if (IsAllIE_Call == "true") {
                IE_CD = "";
            }
            $("#dtCOIEWiseCalls").DataTable({
                stateSave: false,// Design Assets
                autoWidth: true,
                scrollX: true,
                scrollCollapse: true,
                processing: true, // ServerSide Setups
                serverSide: true,
                destroy: true,
                paging: false,// Paging Setups
                searching: true,// Searching Setups
                ajax: {// Ajax Filter
                    url: "@Url.Action("Get_CoIeWiseCalls", "OtherReports")",
                    type: "POST",
                    contentType: "application/json; charset=utf-8",
                    dataType: "json",
                    data: function (d) {
                        var AdditionalValues = {
                            CO: CO_CD,
                            Status: Status_Call,
                            IE: IE_CD,
                            IsAllIE: IsAllIE_Call,
                            IsCallDate: IsCallDate_Sort
                        };
                        d.AdditionalValues = AdditionalValues;
                        return JSON.stringify(d);
                    }
                },

                columns: [
                    {
                        data: "", render: function (data, type, row, meta) {
                            var CASE_NO = row.CASE_NO;
                            var CALL_RECV_DT = row.CALL_RECV_DT;
                            var CALL_SNO = row.CALL_SNO;
                            var html = '<div align=\"center\" class=\"reportIcon\" style=\"text-align: center;\"> <a onclick="ViewReportCOIEWiseCalls(\'' + CASE_NO + '\',\'' + CALL_RECV_DT + '\',\'' + CALL_SNO + '\'); return false; " href="javascript: void (\'0\');" class=\"edit\"><i class=\"fa fa-eye\" title="Report"></i></a>';
                            html += '</div>';
                            return html;
                        }
                    },
                    { data: "IE_NAME" },
                    {
                        data: "",
                        render: function (data, type, row, meta) {
                            var wVendor = "";
                            if (parseInt(row.VEND_CD) == parseInt(row.MFG_CD)) {
                                wVendor = row.VENDOR;
                            } else {
                                wVendor = row.VENDOR + " <font color='#FF00CC'>At<font color='#3333FF'> " + row.MANUFACTURER;
                            }
                            return wVendor;
                        }
                    },
                    {
                        data: "",
                        render: function (row, type, row, meta) {
                            var html = "";
                            if (row.NEW_VENDOR == "Y") {
                                html = "<font size='1' color=crimson face='Verdana'><b>Yes</b></font>";
                            } else {
                                html = "<font size='1' face='Verdana'></font>";
                            }
                            return html;
                        }
                    },
                    { data: "CONSIGNEE" },
                    {
                        data: "",
                        render: function (data, type, row, meta) {

                            var html = "";
                            if (parseInt(row.COUNT) > 1) {
                                html = "<font size='1' face='Verdana'>" + row.ITEM_DESC_PO + "<font color='#FF00CC'> and more items as per call";
                            } else {
                                html = "<font size='1' face='Verdana'>" + row.ITEM_DESC_PO;
                            }
                            return html;
                        }
                    },
                    { data: "EXT_DELV_DT" },
                    { data: "INSP_DESIRE_DT" },
                    { data: "CALL_MARK_DT" },
                    { data: "CALL_SNO" },
                    {
                        data: "", // Calls Documents pdf
                        render: function (data, type, row, meta) {
                            var fpath = "@IBS.Helper.Enums.GetEnumDescription(Enums.FolderPath.Vendor)" + "/CALLS_DOCUMENTS/" + row.CASE_NO + "-" + row.CALL_RECV_DT.toString().substring(6, 4) + row.CALL_RECV_DT.toString().substring(3, 2) + row.CALL_RECV_DT.toString().substring(0, 2) + row.CASE_NO + ".pdf";
                            var html = "";
                            if (row.IsCallDocument) {
                                html = "<a href='" + fpath + "' Font-Names='Verdana' Font-Size='8pt'><font size='1' face='Verdana'>Call Documents</font></a>";
                            } else {
                                html = "<font size='1' face='Verdana'></font>";
                            }
                            return html;
                        }
                    },
                    {
                        data: "", //Check PO_SOURCE == C and CaseNo tif and PDf
                        render: function (data, type, row, meta) {
                            var fpath = "@IBS.Helper.Enums.GetEnumDescription(Enums.FolderPath.Vendor)" + "/CALLS_DOCUMENTS/" + row.CASE_NO + "-" + row.CALL_RECV_DT.toString().substring(6, 4) + row.CALL_RECV_DT.toString().substring(3, 2) + row.CALL_RECV_DT.toString().substring(0, 2) + row.CASE_NO + ".pdf";
                            var html = "";
                            var tifCaseNo = "@IBS.Helper.Enums.GetEnumDescription(Enums.FolderPath.CaseNo)" + "/" + row.CASE_NO + ".TIF";
                            var pdfCaseNo = "@IBS.Helper.Enums.GetEnumDescription(Enums.FolderPath.CaseNo)" + "/" + row.CASE_NO + ".PDF";
                            if (row.PO_SOURCE == "C") {
                                html = "<a href='https://www.ireps.gov.in/ireps/etender/pdfdocs/MMIS/PO/" + row.PO_YR + "/" + row.SS + "/" + row.PO_NO + ".pdf' Font-Names='Verdana' Font-Size='8pt'><font size='1' face='Verdana'>" + row.CASE_NO + "</font></a>";
                            }
                            else {
                                if (row.IsCaseNoTif == true) {
                                    html = "<a href='" + tifCaseNo + "' Font-Names='Verdana' Font-Size='8pt'><font size='1' face='Verdana'>" + row.CASE_NO + "</font></a>";
                                }
                                else if (row.IsCaseNoPdf == true) {
                                    html = "<a href='" + pdfCaseNo + "' Font-Names='Verdana' Font-Size='8pt'><font size='1' face='Verdana'>" + row.CASE_NO + "</font></a>";
                                } else {
                                    html = "<font size='1' face='Verdana' >" + row.CASE_NO;
                                }
                            }
                            return html;
                        }
                    },
                    //{ data: "VIST" }, Status  = M then display column for VIST
                    { data: "SOURCE" },
                    {
                        data: "", // Call Status Full
                        render: function (data, type, row, meta) {
                            debugger
                            var pdfLab = "@IBS.Helper.Enums.GetEnumDescription(Enums.FolderPath.Lab)" + "/" + row.MyFile_ex + ".PDF";
                            var html = "<font size='1' face='Verdana' color=" + row.COLOUR + ">" + row.CALL_STATUS_FULL + "</font>";
                            if (row.CALL_STATUS == "U") {
                                if (row.Lab_Status != "" && row.Lab_Status != null) {
                                    //if (data != "" && data != null) {
                                    html += "<br><p><font size='1' face='Verdana'>" + row.Lab_Status + "</font></p>";
                                } else {
                                    html += "<br><p><font size='1' face='Verdana'>Sample Not Recieved in Lab.</font></p>";
                                }

                                if (row.IsLabPdf == true) {
                                    html += "<a href='" + pdfLab + "' Font-Names='Verdana' Font-Size='8pt'>Lab Report</a>"
                                }
                            }
                            return html;
                        }
                    },
                    //{ data: "" }, //IC_PHOTO path doc
                    { data: "REMARKS" },
                    { data: "PO_NO" },
                    { data: "PO_DATE" },
                    { data: "MFG_PERS" },
                    { data: "MFG_PHONE" },
                    { data: "USER_ID" },
                    { data: "DATETIME" }
                ],
                "order": [[0, "asc"]]
            });
        }

        function ClearControls1() {
            $("#month").val('');
            $("#year").val('');
            $("#FromDate").val('');
            $("#ToDate").val('');
            $("#formonth").prop("checked", true);
            $("#divdate").hide();
            $("#divmonth").show();
        }

        function SubmitNCRC() {

            $("#spnErrorToDate").html("");
            $("#spnErrorFromDate").html("");
            $("#spnErrormonth").html("");
            $("#spnErroryear").html("");
            var formonth = $("#formonth").is(":checked") == true ? "true" : "false";
            var forperiod = $("#forperiod").is(":checked") == true ? "true" : "false";
            var IsValid = true;

            if (formonth == "true") {
                if ($("#month").val() == "") {
                    $("#spnErrormonth").html("Select Month");
                    IsValid = false;
                }
                if ($("#year").val() == "") {
                    $("#spnErroryear").html("Select Year");
                    IsValid = false;
                }
            }



            if (forperiod == "true") {
                if ($("#FromDate").val() == "") {
                    $("#spnErrorFromDate").html("Enter From Date.");
                    IsValid = false;
                }
                if ($("#ToDate").val() == "") {
                    $("#spnErrorToDate").html("Enter To Date.");
                    IsValid = false;
                }
                if ($("#FromDate").val() != "" && IsValidDate($("#FromDate").val()) == false) {
                    $("#spnErrorFromDate").html("Invalid date format.");
                    IsValid = false;
                }
                if ($("#ToDate").val() != "" && IsValidDate($("#ToDate").val()) == false) {
                    $("#spnErrorToDate").html("Invalid date format.");
                    IsValid = false;
                }
            }

            if (!IsValid) return;
            var IsValid = true;
            var ReportType = '@ReportType';
            var monthChar = $('#month option:selected').text();
            var month = getMonthNumber(monthChar);
            var year = $('#year').val();
            var FromDate = $('#FromDate').val();
            var ToDate = $('#ToDate').val();
            var AllCM = $("#AllCM").is(":checked") == true ? "true" : "false";
            var forCM = $("#forCM").is(":checked") == true ? "true" : "false";
            var All = $("#All").is(":checked") == true ? "true" : "false";
            var Outstanding = $("#Outstanding").is(":checked") == true ? "true" : "false";
            var formonth = $("#formonth").is(":checked") == true ? "true" : "false";
            var forperiod = $("#forperiod").is(":checked") == true ? "true" : "false";
            var iecmname = $('#iecmname').val();
            var COName = $('#iecmname option:selected').text();
            var IENametext = $('#iecmname option:selected').text();


            $('#frmC').find("#hdnReportType").val(ReportType);
            $('#frmC').find("#hdnmonthtxt").val(monthChar);
            $('#frmC').find("#hdnmonth").val(month);
            $('#frmC').find("#hdnyear").val(year);
            $('#frmC').find("#hdnFromDate").val(FromDate);
            $('#frmC').find("#hdnToDate").val(ToDate);
            $('#frmC').find("#hdnAllCM").val(AllCM);
            $('#frmC').find("#hdnforCM").val(forCM);
            $('#frmC').find("#hdnAll").val(All);
            $('#frmC').find("#hdnOutstanding").val(Outstanding);
            $('#frmC').find("#hdnformonth").val(formonth);
            $('#frmC').find("#hdnforperiod").val(forperiod);
            $('#frmC').find("#hdniecmname").val(iecmname);
            $('#frmC').find("#hdnCOName").val(COName);
            $('#frmC').find("#hdnIENametext").val(IENametext);

            $("#frmC").submit();

        }

        function getMonthNumber(monthName) {

            const date = new Date(`${monthName} 1, 2000`);
            const monthNumber = (date.getMonth() + 1).toString().padStart(2, '0');
            return monthNumber;
        }

        function ClearControlsIEWISET() {
            $("#IENAME").val('');
            $("#TrainingArea").val('');
            $("#TrainingArea").hide();
            $("#IENAME").hide();
            $("#Alldescipline").prop("checked", true);
            $("#AllIeCat").prop("checked", true);
            $("#AllIe").prop("checked", true);
            $("#AllArea").prop("checked", true);
        }

        function ViewReportIEWISET() {
            var ReportType = '@ReportType';
            var IENAME = $('#IENAME').val();
            var TrainingArea = $('#TrainingArea').val();
            var Mechanical = $("#Mechanical").is(":checked") == true ? "true" : "false";
            var Electrical = $("#Electrical").is(":checked") == true ? "true" : "false";
            var Civil = $("#Civil").is(":checked") == true ? "true" : "false";
            var Regular = $("#Regular").is(":checked") == true ? "true" : "false";
            var Deputaion = $("#Deputaion").is(":checked") == true ? "true" : "false";
            var Particularie = $("#Particularie").is(":checked") == true ? "true" : "false";
            var ParticularArea = $("#ParticularArea").is(":checked") == true ? "true" : "false";

            $('#frmIEWISET').find("#hdnReportType").val(ReportType);
            $('#frmIEWISET').find("#hdnIENAME").val(IENAME);
            $('#frmIEWISET').find("#hdnTrainingArea").val(TrainingArea);
            $('#frmIEWISET').find("#hdnMechanical").val(Mechanical);
            $('#frmIEWISET').find("#hdnElectrical").val(Electrical);
            $('#frmIEWISET').find("#hdnCivil").val(Civil);
            $('#frmIEWISET').find("#hdnRegular").val(Regular);
            $('#frmIEWISET').find("#hdnDeputaion").val(Deputaion);
            $('#frmIEWISET').find("#hdnParticularie").val(Particularie);
            $('#frmIEWISET').find("#hdnParticularArea").val(ParticularArea);

            $("#frmIEWISET").submit();
        }
    </script>
}
