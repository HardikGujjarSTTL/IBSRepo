@inject Microsoft.AspNetCore.Http.IHttpContextAccessor HttpContextAccessor;
@{
    string Region = ViewBag.Region;
    string ReportType = !string.IsNullOrEmpty(HttpContextAccessor.HttpContext.Request.Query["ReportType"]) ? Convert.ToString(HttpContextAccessor.HttpContext.Request.Query["ReportType"]) : "";
    string ReportTitle = string.Empty;

    if (ReportType == "ConInsp") ReportTitle = "Summary of Consignee Wise Inspections";
    else if (ReportType == "VenInsp") ReportTitle = "Summary of Vendor Wise Inspections";
    else if (ReportType == "RTIInsp") ReportTitle = "SUMMARY OF INSPECTIONS FOR RTI";
   
    ViewData["Title"] = ReportTitle;
}

<div class="list-inner">
    <div class="tast-list">
        <h2>@ReportTitle</h2>
    </div>
</div>
<div class="task-listinput">
    <div class="accordion-body">
        <div class="task-inner row report1" style="display: none">
            <div class="row">
                <div class="col-md-5 mb-3" style="margin-top:auto;">
                    <label for="PropertyId">For All Consignee's</label>
                    <input type="radio" name="radioGroup" id="rb1" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-5 mb-3" style="margin-top:auto;">
                    <label for="PropertyId">For Particular Consignee</label>
                    <input type="radio" name="radioGroup" id="rb2" />
                    <span class="text-danger"></span>
                </div>

            </div>
            <div class="row">
                <div class="col-md-7 mb-3" id="ddlc" style="display:none;">
                    <label for="PropertyId">Select Particular Consignee</label>
                    @Html.DropDownList("CONSIGNEE", Common.GetSummaryConsignee(), new { @id="ddlcon"})
                    <span class="text-danger"></span>
                </div>
            </div>
            <div class="row">
                <div class="col-md-2 mb-3" style="margin-top:auto;">
                    <label for="PropertyId">For the Month</label>
                    <input type="radio" name="radioGroup2" id="rb3" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-2 mb-3" style="margin-top:auto;">
                    <label for="PropertyId">For Given Period</label>
                    <input type="radio" name="radioGroup2" id="rb4" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-2 mb-3" style="display:none" id="dtf">
                    <label for="PropertyId">From Date</label>
                    <input type="text" class="input datepicker" id="dtfrom" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-2 mb-3" style="display:none" id="dtt">
                    <label for="PropertyId">To Date</label>
                    <input type="text" class="input datepicker" id="dtto" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-2 mb-3" id="dd1">
                    <label for="PropertyId">Month</label>
                    @Html.DropDownList("Month", Common.GetMonth(), new { @id="ddlmonth"})
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-2 mb-3" id="dd2">
                    <label for="PropertyId">Year</label>
                    @Html.DropDownList("Year", Common.GetYear(), new { @id="ddlyear"})
                    <span class="text-danger"></span>
                </div>
            </div>
            <div class="row">
                <label>Report based on </label>
                <div class="col-md-3 mb-3">
                    <label for="PropertyId">IC Date</label>
                    <input type="radio" name="radioGroup3" id="rb5" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-3 mb-3">
                    <label for="PropertyId">Bill Date</label>
                    <input type="radio" name="radioGroup3" id="rb6" />
                    <span class="text-danger"></span>
                </div>
            </div>
            <div class="row">
                <label>Report to be Sorted on </label>
                <div class="col-md-3 mb-3">
                    <label for="PropertyId">Consignee Name</label>
                    <input type="radio" name="radioGroup4" id="rb7" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-3 mb-3">
                    <label for="PropertyId">Material Value</label>
                    <input type="radio" name="radioGroup4" id="rb8" />
                    <span class="text-danger"></span>
                </div>
            </div>
            <div class="col-md-3" style="margin-top: 30px;">
                <div class="savenext-btn">
                    <button type="button" class="save-btn active" onclick="ViewReport1();">Submit</button>
                    <button type="button" class="reset-btn" onclick="ClearControls();">Clear</button>
                </div>
            </div>
        </div>
        <div class="task-inner row report2" style="display: none">
            <div class="row my-0">
                <div class="col-md-5 mb-3" style="margin-top:auto;">
                    <label for="PropertyId">For All Vendor's</label>
                    <input type="radio" name="VradioGroup" id="Vrb1" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-5 mb-3" style="margin-top:auto;">
                    <label for="PropertyId">For Particular Vendor</label>
                    <input type="radio" name="VradioGroup" id="Vrb2" />
                    <span class="text-danger"></span>
                </div>

            </div>
            <div class="row my-0">
                <div class="col-md-7 mb-3" id="ddlc" style="display:none;">
                    <label for="PropertyId">Select Particular Vendor</label>
                    @Html.DropDownList("VENDOR", Common.GetVendorLabRpt(), new { @id="Vddlcon"})
                    <span class="text-danger"></span>
                </div>
            </div>
            <div class="row my-0">
                <div class="col-md-2 mb-3" style="margin-top:auto;">
                    <label for="PropertyId">For the Month</label>
                    <input type="radio" name="VradioGroup2" id="Vrb3" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-2 mb-3" style="margin-top:auto;">
                    <label for="PropertyId">For Given Period</label>
                    <input type="radio" name="VradioGroup2" id="Vrb4" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-2 mb-3" style="display:none" id="Vdtf">
                    <label for="PropertyId">From Date</label>
                    <input type="text" class="input datepicker" id="Vdtfrom" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-2 mb-3" style="display:none" id="Vdtt">
                    <label for="PropertyId">To Date</label>
                    <input type="text" class="input datepicker" id="Vdtto" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-2 mb-3" id="Vdd1">
                    <label for="PropertyId">Month</label>
                    @Html.DropDownList("Month", Common.GetMonth(), new { @id="Vddlmonth"})
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-2 mb-3" id="Vdd2">
                    <label for="PropertyId">Year</label>
                    @Html.DropDownList("Year", Common.GetYear(), new { @id="Vddlyear"})
                    <span class="text-danger"></span>
                </div>
            </div>
            <div class="row my-0">
                <label>Report based on </label>
                <div class="col-md-3 mb-3">
                    <label for="PropertyId">IC Date</label>
                    <input type="radio" name="VradioGroup3" id="Vrb5" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-3 mb-3">
                    <label for="PropertyId">Bill Date</label>
                    <input type="radio" name="VradioGroup3" id="Vrb6" />
                    <span class="text-danger"></span>
                </div>
            </div>
            <div class="row my-0">
                <label>Report to be Sorted on </label>
                <div class="col-md-3 mb-3">
                    <label for="PropertyId">Vendor Name</label>
                    <input type="radio" name="VradioGroup4" id="Vrb7" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-3 mb-3">
                    <label for="PropertyId">Material Value</label>
                    <input type="radio" name="VradioGroup4" id="Vrb8" />
                    <span class="text-danger"></span>
                </div>
            </div>
            <div class="col-md-3" style="margin-top: 30px;">
                <div class="savenext-btn">
                    <button type="button" class="save-btn active" onclick="ViewReport2();">Submit</button>
                    <button type="button" class="reset-btn" onclick="ClearControls();">Clear</button>
                </div>
            </div>
        </div>
        <div class="task-inner row report3" style="display: none">
            <div class="row my-0">
                <div class="col-md-8 mb-3">
                    <label for="Reference" style="width: 100%;">
                        Select Purchaser
                    </label>
                    <input type="text" class="input" id="txtSPur" style="width: 46%;">
                    <button type="button" class="save-btn active" onclick="SearchPurchaser();">Search Purchaser</button>
                </div>

            </div>
            <div class="row my-0">
                <div class="col-md-12 mb-3" style="display:none;" id="hdnPDropdown">
                    <label for="Reference"></label>
                    <select id="PurchaserCD"></select>
                </div>
            </div>
            <div class="row my-0">
                <div class="col-md-5 mb-3" style="margin-top:auto;">
                    <label for="PropertyId">All Purchasers</label>
                    <input type="radio" name="RradioGroup" id="Rrb1" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-5 mb-3" style="margin-top:auto;">
                    <label for="PropertyId">For Particular Purchaser</label>
                    <input type="radio" name="RradioGroup" id="Rrb2" />
                    <span class="text-danger"></span>
                </div>

            </div>
            <div class="row my-0">
                <div class="col-md-2 mb-3" style="margin-top:auto;">
                    <label for="PropertyId">For the Month</label>
                    <input type="radio" name="RradioGroup2" id="Rrb3" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-2 mb-3" style="margin-top:auto;">
                    <label for="PropertyId">For Given Period</label>
                    <input type="radio" name="RradioGroup2" id="Rrb4" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-2 mb-3" style="display:none" id="Rdtf">
                    <label for="PropertyId">From Date</label>
                    <input type="text" class="input datepicker" id="Rdtfrom" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-2 mb-3" style="display:none" id="Rdtt">
                    <label for="PropertyId">To Date</label>
                    <input type="text" class="input datepicker" id="Rdtto" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-2 mb-3" id="dd1">
                    <label for="PropertyId">Month</label>
                    @Html.DropDownList("Month", Common.GetMonth(), new { @id="Rddlmonth"})
                    <span  class="text-danger"></span>
                </div>
                <div class="col-md-2 mb-3" id="dd2">
                    <label for="PropertyId">Year</label>
                    @Html.DropDownList("Year", Common.GetYear(), new { @id="Rddlyear"})
                    <span class="text-danger"></span>
                </div>
            </div>
            <div class="row my-0">
                <label>Report based on </label>
                <div class="col-md-3 mb-3">
                    <label for="PropertyId">IC Date</label>
                    <input type="radio" name="RradioGroup3" id="Rrb5" />
                    <span class="text-danger"></span>
                </div>
                <div class="col-md-3 mb-3">
                    <label for="PropertyId">Bill Date</label>
                    <input type="radio" name="RradioGroup3" id="Rrb6" />
                    <span class="text-danger"></span>
                </div>
            </div>
            <div class="col-md-3" style="margin-top: 30px;">
                <div class="savenext-btn">
                    <button type="button" class="save-btn active" onclick="ViewReport3();">Submit</button>
                    <button type="button" class="reset-btn" onclick="ClearControls();">Clear</button>
                </div>
            </div>
        </div>
    </div>
</div>

@section scripts{

    <partial name="_DataTablesScriptsPartial" />
    <partial name="_ValidationScriptsPartial" />

    <script type="text/javascript">
        function ClearControls() {
            location.reload(true);
        }

        $('input[name="radioGroup"]').change(function () {

            var selectedId = $(this).attr('id');
            if (selectedId == "rb1") {
                sessionStorage.removeItem("rbb1");
                sessionStorage.removeItem("rbb2");
                sessionStorage.setItem("rbb1", true);
                $("#ddlc").css("display", "none");
            }
            else {
                sessionStorage.removeItem("rbb1");
                sessionStorage.removeItem("rbb2");
                sessionStorage.setItem("rbb2", true);
                sessionStorage.setItem("con", $("#ddlcon").val());
                $("#ddlc").css("display", "block");
            }

        });
        $('input[name="radioGroup3"]').change(function () {
            var selectedId = $(this).attr('id');
            if (selectedId == "rb5") {
                sessionStorage.removeItem("rbb5");
                sessionStorage.removeItem("rbb6");
                sessionStorage.setItem("rbb5", true);
                //$("#dd1").css("display", "none");
            }
            else {
                sessionStorage.removeItem("rbb5");
                sessionStorage.removeItem("rbb6");
                sessionStorage.setItem("rbb6", true);
                //$("#dd1").css("display", "block");
            }
        });
        $('input[name="radioGroup2"]').change(function () {

            var selectedId = $(this).attr('id');
            if (selectedId == "rb3") {
                sessionStorage.removeItem("rbb3");
                sessionStorage.removeItem("rbb4");
                sessionStorage.setItem("rbb4", false);
                $("#dtf").css("display", "none");
                $("#dtt").css("display", "none");
                $("#dd1").css("display", "block");
                $("#dd2").css("display", "block");

            }
            else {
                sessionStorage.removeItem("rbb3");

                sessionStorage.removeItem("rbb4");
                sessionStorage.setItem("rbb4", true);

                $("#dtf").css("display", "block");
                $("#dtt").css("display", "block");
                $("#dd1").css("display", "none");
                $("#dd2").css("display", "none");
            }
        });
        $('input[name="radioGroup4"]').change(function () {
            var selectedId = $(this).attr('id');
            if (selectedId == "rb7") {
                sessionStorage.removeItem("rbb7");
                sessionStorage.removeItem("rbb8");
                sessionStorage.setItem("rbb7", true);
                //$("#dd1").css("display", "none");
            }
            else {
                sessionStorage.removeItem("rbb8");
                sessionStorage.removeItem("rbb7");
                sessionStorage.setItem("rbb8", true);
                //$("#dd1").css("display", "block");
            }
        });

        $('input[name="VradioGroup"]').change(function () {

            var selectedId = $(this).attr('id');
            if (selectedId == "Vrb1") {
                sessionStorage.removeItem("Vrbb1");
                sessionStorage.removeItem("Vrbb2");
                sessionStorage.setItem("Vrbb1", true);
                $("#Vddlc").css("display", "none");
            }
            else {
                sessionStorage.removeItem("Vrbb1");
                sessionStorage.removeItem("Vrbb2");
                sessionStorage.setItem("Vrbb2", true);
                sessionStorage.setItem("Vcon", $("#Vddlcon").val());
                $("#Vddlc").css("display", "block");
            }

        });
        $('input[name="VradioGroup3"]').change(function () {
            var selectedId = $(this).attr('id');
            if (selectedId == "Vrb5") {
                sessionStorage.removeItem("Vrbb5");
                sessionStorage.removeItem("Vrbb6");
                sessionStorage.setItem("Vrbb5", true);
                //$("#dd1").css("display", "none");
            }
            else {
                sessionStorage.removeItem("Vrbb5");
                sessionStorage.removeItem("Vrbb6");
                sessionStorage.setItem("Vrbb6", true);
                //$("#dd1").css("display", "block");
            }
        });
        $('input[name="VradioGroup2"]').change(function () {

            var selectedId = $(this).attr('id');
            if (selectedId == "Vrb3") {
                sessionStorage.removeItem("Vrbb3");
                sessionStorage.removeItem("Vrbb4");
                sessionStorage.setItem("Vrbb4", false);
                $("#Vdtf").css("display", "none");
                $("#Vdtt").css("display", "none");
                $("#Vdd1").css("display", "block");
                $("#Vdd2").css("display", "block");

            }
            else {
                sessionStorage.removeItem("Vrbb3");

                sessionStorage.removeItem("Vrbb4");
                sessionStorage.setItem("Vrbb4", true);

                $("#Vdtf").css("display", "block");
                $("#Vdtt").css("display", "block");
                $("#Vdd1").css("display", "none");
                $("#Vdd2").css("display", "none");
            }
        });
        $('input[name="VradioGroup4"]').change(function () {
            var selectedId = $(this).attr('id');
            if (selectedId == "Vrb7") {
                sessionStorage.removeItem("Vrbb7");
                sessionStorage.removeItem("Vrbb8");
                sessionStorage.setItem("Vrbb7", true);
                //$("#dd1").css("display", "none");
            }
            else {
                sessionStorage.removeItem("Vrbb8");
                sessionStorage.removeItem("Vrbb7");
                sessionStorage.setItem("Vrbb8", true);
                //$("#dd1").css("display", "block");
            }
        });

        $('input[name="RradioGroup"]').change(function () {

            var selectedId = $(this).attr('id');
            if (selectedId == "Rrb1") {
                sessionStorage.removeItem("Rrbb1");
                sessionStorage.removeItem("Rrbb2");
                sessionStorage.setItem("Rrbb1", true);

            }
            else {
                sessionStorage.removeItem("Rrbb1");
                sessionStorage.removeItem("Rrbb2");
                sessionStorage.setItem("Rrbb2", true);


            }

        });
        $('input[name="RradioGroup3"]').change(function () {
            var selectedId = $(this).attr('id');
            if (selectedId == "Rrb5") {
                sessionStorage.removeItem("Rrbb5");
                sessionStorage.removeItem("Rrbb6");
                sessionStorage.setItem("Rrbb5", true);
                //$("#dd1").css("display", "none");
            }
            else {
                sessionStorage.removeItem("Rrbb5");
                sessionStorage.removeItem("Rrbb6");
                sessionStorage.setItem("Rrbb6", true);
                //$("#dd1").css("display", "block");
            }
        });

        $('input[name="RradioGroup2"]').change(function () {

            var selectedId = $(this).attr('id');
            if (selectedId == "Rrb3") {
                sessionStorage.removeItem("Rrbb3");
                sessionStorage.removeItem("Rrbb4");
                sessionStorage.setItem("Rrbb4", false);
                $("#Rdtf").css("display", "none");
                $("#Rdtt").css("display", "none");
                $("#Rdd1").css("display", "block");
                $("#Rdd2").css("display", "block");

            }
            else {
                sessionStorage.removeItem("Rrbb3");

                sessionStorage.removeItem("Rrbb4");
                sessionStorage.setItem("Rrbb4", true);

                $("#Rdtf").css("display", "block");
                $("#Rdtt").css("display", "block");
                $("#Rdd1").css("display", "none");
                $("#Rdd2").css("display", "none");
            }
        });

        $(function () {
            $("#rb1").prop("checked", true);
            $("#rb3").prop("checked", true);
            $("#rb5").prop("checked", true);
            sessionStorage.setItem("rbb5", true);
            sessionStorage.setItem("rbb4", false);
            $("#rb7").prop("checked", true);
            $("#Vrb1").prop("checked", true);
            $("#Vrb3").prop("checked", true);
            $("#Vrb5").prop("checked", true);
            sessionStorage.setItem("Vrbb5", true);
            sessionStorage.setItem("Vrbb4", false);
            $("#Vrb7").prop("checked", true);
            $("#Rrb1").prop("checked", true);
            $("#Rrb3").prop("checked", true);
            $("#Rrb5").prop("checked", true);
            sessionStorage.setItem("Rrbb5", true);
            sessionStorage.setItem("Rrbb4", false);
            if ('@ReportType' == 'ConInsp') {
                $(".report1").css("display", "");                
            }
            else if ('@ReportType' == 'VenInsp') {
                $(".report2").css("display", "");                
            }
            else if ('@ReportType' == 'RTIInsp') {
                $(".report3").css("display", "");
            }
        });
        function FillPurchaserCd(ids) {
            var txtSPur = $("#txtSPur").val();
            $.ajax({
                url: '@Url.Action("GetPurchaserCd", "InspectionStatus")?Purchaser=' + txtSPur,
                type: 'GET',
                cache: false,
                data: '{}',
                processData: false,
                contentType: false
            }).done(function (response) {
                if (response.status) {
                    $("#PurchaserCD").html("");
                    $("#PurchaserCD").append("<option value=''>--Select--</option>");
                    var id = 0;
                    $.each(response.list, function (index, value) {
                        $("#PurchaserCD").append("<option value=" + value.Value + ">" + value.Text + "</option>");
                        if (value.Selected == true) {
                            id = value.Value;
                        }
                    });
                    if (id > 0) {
                        $("#PurchaserCD").val(id);
                    }
                    if (ids > 0) {
                        $("#PurchaserCD").val(ids);
                    }
                    //$("#hdnRCD").val($("#RlyCd").val());
                    //$("#hdnRailway").val($("#RlyCd option:selected").text());
                }
            });
        }
        function SearchPurchaser() {
            FillPurchaserCd();
            $("#hdnPDropdown").css("display", "block");
        }
        function ViewReport1() {
            var ReportType = '@ReportType';
            var ForGiven = sessionStorage.getItem("rbb4");
            var ReportBasedon = sessionStorage.getItem("rbb5");
            var MaterialValue = sessionStorage.getItem("rbb8");
            if (sessionStorage.getItem("rbb4") == "false") {
                var Month = $("#ddlmonth").val();
                var Year = $("#ddlyear").val();
            }
            else {
                var parts = $("#dtfrom").val().split('/');
                var FromDate = parts[1] + '/' + parts[0] + '/' + parts[2];
                var parts2 = $("#dtto").val().split('/');
                var ToDate = parts2[1] + '/' + parts2[0] + '/' + parts2[2];

            }

            var ForParticular = sessionStorage.getItem("rbb2");
            var lstParticular = sessionStorage.getItem("con");
            let myObject = {ReportType, ForGiven, ReportBasedon, MaterialValue, FromDate, ToDate, Month, Year, ForParticular, lstParticular };

            var url = '@Url.Action("Manage", "InspectionStatus")?' + $.param(myObject);
            window.open(url, '_blank');
        }
        function ViewReport2() {

            var ReportType = '@ReportType';
            var ForGiven = sessionStorage.getItem("Vrbb4");
            var ReportBasedon = sessionStorage.getItem("Vrbb5");
            var MaterialValue = sessionStorage.getItem("Vrbb8");
            if (sessionStorage.getItem("Vrbb4") == "false") {
                var Month = $("#Vddlmonth").val();
                var Year = $("#Vddlyear").val();
            }
            else {
                var parts = $("#Vdtfrom").val().split('/');
                var FromDate = parts[1] + '/' + parts[0] + '/' + parts[2];
                var parts2 = $("#Vdtto").val().split('/');
                var ToDate = parts2[1] + '/' + parts2[0] + '/' + parts2[2];

            }

            var ForParticular = sessionStorage.getItem("Vrbb2");
            var lstParticular = sessionStorage.getItem("Vcon");
            let myObject = { ReportType, ForGiven, ReportBasedon, MaterialValue, FromDate, ToDate, Month, Year, ForParticular, lstParticular };

            var url = '@Url.Action("Manage", "InspectionStatus")?' + $.param(myObject);
            window.open(url, '_blank');
        }
        function ViewReport3() {

            // var ReportType = "Summary of Consignee Wise Inspections";
            var ReportType = '@ReportType';
            var ForGiven = sessionStorage.getItem("Rrbb4");
            var ReportBasedon = sessionStorage.getItem("Rrbb5");
            var TextPurchaser = $("#txtSPur").val();
            if (sessionStorage.getItem("Rrbb4") == "false") {
                var Month = $("#Rddlmonth").val();
                var Year = $("#Rddlyear").val();
            }
            else {
                var parts = $("#Rdtfrom").val().split('/');
                var FromDate = parts[1] + '/' + parts[0] + '/' + parts[2];
                var parts2 = $("#Rdtto").val().split('/');
                var ToDate = parts2[1] + '/' + parts2[0] + '/' + parts2[2];

            }

            var ForParticular = sessionStorage.getItem("Rrbb2");
            var lstParticular = $("#PurchaserCD").val();
            let myObject = {ReportType, ForGiven, ReportBasedon, FromDate, ToDate, Month, Year, ForParticular, lstParticular, TextPurchaser };

            var url = '@Url.Action("Manage", "InspectionStatus")?' + $.param(myObject);
            window.open(url, '_blank');
        }
    </script>
}